generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model games {
  game_id                      String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  winner_id                    String    @db.Uuid
  loser_id                     String    @db.Uuid
  num_moves                    Int?      @default(0) @db.SmallInt
  created_at                   DateTime? @default(now()) @db.Timestamptz(6)
  chat_log_id                  String?   @db.Uuid
  users_games_loser_idTousers  users     @relation("games_loser_idTousers", fields: [loser_id], references: [user_id])
  users_games_winner_idTousers users     @relation("games_winner_idTousers", fields: [winner_id], references: [user_id])
}

model message {
  message_id                        String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  chat_log_id                       String    @db.Uuid
  sender_id                         String    @db.Uuid
  recipient_id                      String    @db.Uuid
  flagged                           Boolean   @default(false)
  created_at                        DateTime? @default(now()) @db.Timestamptz(6)
  users_message_recipient_idTousers users     @relation("message_recipient_idTousers", fields: [recipient_id], references: [user_id])
  users_message_sender_idTousers    users     @relation("message_sender_idTousers", fields: [sender_id], references: [user_id])
}

model migrations {
  id          Int       @id
  name        String    @unique @db.VarChar(100)
  hash        String    @db.VarChar(40)
  executed_at DateTime? @default(now()) @db.Timestamp(6)
}

model users {
  user_id                             String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  username                            String    @unique @db.VarChar(20)
  salt                                String    @unique @db.VarChar(12)
  passhash                            String    @db.VarChar
  win_count                           Int       @default(0) @db.SmallInt
  loss_count                          Int       @default(0) @db.SmallInt
  created_at                          DateTime? @default(now()) @db.Timestamptz(6)
  last_login                          DateTime? @db.Timestamptz(6)
  games_games_loser_idTousers         games[]   @relation("games_loser_idTousers")
  games_games_winner_idTousers        games[]   @relation("games_winner_idTousers")
  message_message_recipient_idTousers message[] @relation("message_recipient_idTousers")
  message_message_sender_idTousers    message[] @relation("message_sender_idTousers")
}
